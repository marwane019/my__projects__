<!doctype html><html lang='en'><head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<title>K‑Means Cluster Lab</title><link rel='stylesheet' href='../../assets/css/style.css'></head><body>
<header class='nav'><div class='container'><a class='brand' href='../../index.html'>&larr; Back</a><button id='theme' class='btn'>Theme</button></div></header>
<section class='container prose'>
  <h2>K‑Means Cluster Lab</h2>
  <p><strong>What you see:</strong> a scatterplot of points colored by cluster with white centroids. Each step reassigns points and moves centroids.</p>
  <p><strong>How to use:</strong> set k; click Step or Auto; Regenerate to get a new dataset. Silhouette gives a rough quality score.</p>
  
<div class="controls">
  <label>k <input id="k" type="range" min="2" max="8" value="4"></label>
  <button class="btn" id="regen">Regenerate</button>
  <button class="btn" id="iterate">Step</button>
  <button class="btn" id="auto">Auto</button>
  <span class="kpi">Silhouette: <span id="sil">0</span></span>
</div>
<canvas id="scatter" width="900" height="520" class="chart"></canvas>

</section>
<footer><div class='container'>Contact: <a href='mailto:ambrosetheshield6@gmail.com'>ambrosetheshield6@gmail.com</a></div></footer>
<script>document.getElementById('theme').onclick=()=>document.documentElement.classList.toggle('light');</script>

<script>
const cv=document.getElementById('scatter'), ctx=cv.getContext('2d');
let pts=[], cent=[], labels=[], timer=null;
function rndn(mu=0, sigma=1){ // Box-Muller
  let u=0,v=0; while(u===0)u=Math.random(); while(v===0)v=Math.random();
  return mu + sigma*Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);
}
function gen(){pts=[]; const groups=4+Math.floor(Math.random()*3); for(let g=0; g<groups; g++){const cx=Math.random()*0.8+0.1, cy=Math.random()*0.8+0.1, s=0.04+Math.random()*0.05; const n=90; for(let i=0;i<n;i++){pts.push({x:Math.min(0.98,Math.max(0.02,rndn(cx,s))), y:Math.min(0.98,Math.max(0.02,rndn(cy,s)))});} }
  labels=new Array(pts.length).fill(0); cent=[]; const K=+document.getElementById('k').value; for(let i=0;i<K;i++){cent.push({x:Math.random(),y:Math.random()})}
}
function assign(){ for(let i=0;i<pts.length;i++){ let best=0, bd=1e9; for(let k=0;k<cent.length;k++){ const dx=pts[i].x-cent[k].x, dy=pts[i].y-cent[k].y; const d=dx*dx+dy*dy; if(d<bd){bd=d; best=k} } labels[i]=best; } }
function update(){ const K=cent.length; const sum=new Array(K).fill(0).map(_=>({x:0,y:0,c:0})); for(let i=0;i<pts.length;i++){const k=labels[i]; sum[k].x+=pts[i].x; sum[k].y+=pts[i].y; sum[k].c++;}
  for(let k=0;k<K;k++){ if(sum[k].c>0){cent[k].x=sum[k].x/sum[k].c; cent[k].y=sum[k].y/sum[k].c;} } }
function silhouette(){ const K=cent.length; const counts=new Array(K).fill(0); const sums=new Array(K).fill(0);
  for(let i=0;i<pts.length;i++){const ki=labels[i]; counts[ki]++; for(let j=0;j<pts.length;j++){ if(i===j) continue; const d=Math.hypot(pts[i].x-pts[j].x, pts[i].y-pts[j].y); if(labels[j]===ki) sums[ki]+=d; } }
  let s=0, c=0; for(let k=0;k<K;k++){ if(counts[k]>1){ s += (sums[k]/(counts[k]*(counts[k]-1))); c++; } } return (c? (1/(1+s)) : 0).toFixed(3); }
function draw(){ ctx.clearRect(0,0,cv.width,cv.height); const w=cv.width, h=cv.height;
  for(let i=0;i<pts.length;i++){ const k=labels[i]; ctx.fillStyle = ['#7db7ff','#ff9a7d','#ffe47d','#a6ff7d','#d97dff','#7dffc7','#ff7dbd'][k%7]; ctx.beginPath(); ctx.arc(pts[i].x*w, pts[i].y*h, 4, 0, 6.283); ctx.fill(); }
  for(let k=0;k<cent.length;k++){ ctx.fillStyle='#ffffff'; ctx.strokeStyle='#1a2b55'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(cent[k].x*w, cent[k].y*h, 8, 0, 6.283); ctx.fill(); ctx.stroke(); }
  document.getElementById('sil').textContent = silhouette();
}
function step(){ assign(); update(); draw(); }
document.getElementById('regen').onclick=()=>{gen(); draw()};
document.getElementById('iterate').onclick=step;
document.getElementById('auto').onclick=()=>{ if(timer){clearInterval(timer); timer=null; return;} timer=setInterval(step, 400); };
document.getElementById('k').oninput=()=>{gen(); draw()};
gen(); draw();
</script>

</body></html>