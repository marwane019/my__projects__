<!doctype html><html lang='en'><head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<title>Image Lab</title><link rel='stylesheet' href='../../assets/css/style.css'></head><body>
<header class='nav'><div class='container'><a class='brand' href='../../index.html'>&larr; Back</a><button id='theme' class='btn'>Theme</button></div></header>
<section class='container prose'>
  <h2>Image Lab</h2>
  <p><strong>What you see:</strong> two canvases: left original, right processed. A vertical slider reveals the processed half.</p>
  <p><strong>How to use:</strong> upload or use the sample; pick a filter; click Apply; drag the middle slider to compare.</p>
  
<div class="controls">
  <input type="file" id="file">
  <select id="filter">
    <option value="edges">Edges</option>
    <option value="sharpen">Sharpen</option>
    <option value="blur">Blur</option>
    <option value="emboss">Emboss</option>
  </select>
  <button class="btn" id="apply">Apply</button>
</div>
<div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
  <canvas id="orig" width="420" height="280" class="stage"></canvas>
  <input id="split" type="range" min="0" max="1" step="0.01" value="0.5" style="flex:1">
  <canvas id="proc" width="420" height="280" class="stage"></canvas>
</div>
<div class="controls">
  <span class="kpi">Mean: <span id="mean">0</span></span>
  <span class="kpi">Std: <span id="std">0</span></span>
</div>

</section>
<footer><div class='container'>Contact: <a href='mailto:ambrosetheshield6@gmail.com'>ambrosetheshield6@gmail.com</a></div></footer>
<script>document.getElementById('theme').onclick=()=>document.documentElement.classList.toggle('light');</script>

<script>
const co=document.getElementById('orig').getContext('2d');
const cp=document.getElementById('proc').getContext('2d');
const o=document.getElementById('orig'), p=document.getElementById('proc');
const img=new Image(); img.onload=()=>{co.drawImage(img,0,0,o.width,o.height); run()}; 
// generate a simple sample image (gradient + shapes)
const tmp=document.createElement('canvas'); tmp.width=420; tmp.height=280; const tctx=tmp.getContext('2d');
const g=tctx.createLinearGradient(0,0,420,280); g.addColorStop(0,'#0e2244'); g.addColorStop(1,'#143466'); tctx.fillStyle=g; tctx.fillRect(0,0,420,280);
tctx.fillStyle='#ffd26a'; tctx.beginPath(); tctx.arc(90,70,30,0,6.283); tctx.fill(); tctx.strokeStyle='#6aa8ff'; tctx.lineWidth=8; tctx.strokeRect(200,80,120,80);
img.src=tmp.toDataURL();

document.getElementById('file').onchange=e=>{const f=e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=()=>{img.src=r.result}; r.readAsDataURL(f);}
document.getElementById('apply').onclick=run; document.getElementById('split').oninput=drawSplit;

function kernel(type){
  if(type==='edges') return [[-1,-1,-1],[-1,8,-1],[-1,-1,-1]];
  if(type==='sharpen') return [[0,-1,0],[-1,5,-1],[0,-1,0]];
  if(type==='blur') return [[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]];
  if(type==='emboss') return [[-2,-1,0],[-1,1,1],[0,1,2]];
}
function stats(data){let s=0; for(let i=0;i<data.length;i+=4) s+=0.299*data[i]+0.587*data[i+1]+0.114*data[i+2]; const mean=s/(data.length/4);
 let v=0; for(let i=0;i<data.length;i+=4){ const g=0.299*data[i]+0.587*data[i+1]+0.114*data[i+2]; v+=(g-mean)*(g-mean);} v/=data.length/4; return [mean,Math.sqrt(v)];
}
function convolve(src,k){const w=src.width,h=src.height; const out=new ImageData(w,h); const m=[[0,1,2],[w,w+1,w+2],[2*w,2*w+1,2*w+2]];
 for(let y=1;y<h-1;y++){for(let x=1;x<w-1;x++){let r=0,g=0,b=0; for(let ky=0;ky<3;ky++){for(let kx=0;kx<3;kx++){const i=((y+ky-1)*w+(x+kx-1))*4; const wgt=k[ky][kx]; r+=src.data[i]*wgt; g+=src.data[i+1]*wgt; b+=src.data[i+2]*wgt;}} const j=(y*w+x)*4; out.data[j]=Math.max(0,Math.min(255,r)); out.data[j+1]=Math.max(0,Math.min(255,g)); out.data[j+2]=Math.max(0,Math.min(255,b)); out.data[j+3]=255; } } return out; }
function drawSplit(){ cp.clearRect(0,0,p.width,p.height); cp.drawImage(o,0,0); const s=+document.getElementById('split').value; const w=p.width*s; cp.globalCompositeOperation='source-over'; cp.drawImage(p._proc,0,0); cp.globalCompositeOperation='destination-in'; cp.fillStyle='#fff'; cp.fillRect(0,0,w,p.height); cp.globalCompositeOperation='source-over'; cp.strokeStyle='#ffd26a'; cp.lineWidth=2; cp.beginPath(); cp.moveTo(w,0); cp.lineTo(w,p.height); cp.stroke(); }
function run(){ const filt=document.getElementById('filter').value; const src=co.getImageData(0,0,o.width,o.height); const out=convolve(src, kernel(filt)); p._proc=document.createElement('canvas'); p._proc.width=o.width; p._proc.height=o.height; p._proc.getContext('2d').putImageData(out,0,0); const [m,s]=stats(src.data); document.getElementById('mean').textContent=m.toFixed(1); document.getElementById('std').textContent=s.toFixed(1); drawSplit(); }
</script>

</body></html>